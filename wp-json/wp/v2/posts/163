{"id":163,"date":"2014-12-15T10:59:22","date_gmt":"2014-12-15T18:59:22","guid":{"rendered":"http:\/\/www.codeapex.com\/?p=163"},"modified":"2014-12-15T10:59:22","modified_gmt":"2014-12-15T18:59:22","slug":"installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default","status":"publish","type":"post","link":"http:\/\/www.codeapex.com\/installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default\/","title":{"rendered":"Installing Bodhi Linux on an Acer C720 Chromebook with SeaBIOS as default."},"content":{"rendered":"<h2>Situation:<\/h2>\n<p>We have an Acer C720 Chromebook and want Chrome OS removed and Bodhi Linux installed on it. Additionally we want to have it boot to Linux by default without having to start SeaBIOS manually by pressing <code>Ctrl + L<\/code> at the white boot splash screen.<\/p>\n<h2>Objective:<\/h2>\n<p>Acer C720 Chromebook with Chrome OS removed and Bodhi Linux installed with SeaBIOS booting by default.<\/p>\n<h2>Plan + Execution:<\/h2>\n<h3>Outline<\/h3>\n<p>The general installation procedure:<\/p>\n<ol>\n<li>Enable developer mode to allow access to the superuser shell in Chrome OS.<\/li>\n<li>Accessing the superuser shell.<\/li>\n<li>Enable legacy boot \/ SeaBIOS.<\/li>\n<li>Set SeaBIOS as default.<\/li>\n<li>Prepare the installation media (USB stick).<\/li>\n<li>Boot from the installation media and install Bodhi Linux.<\/li>\n<\/ol>\n<h3><span id=\"Enabling_Developer_Mode\" class=\"mw-headline\">Enabling Developer Mode<\/span><\/h3>\n<ol>\n<li>Turn on the Chromebook.<\/li>\n<li>Press and hold the <code>Esc + F3 (Refresh)<\/code> keys, then press the <code>Power<\/code> button. This enters Recovery Mode.<\/li>\n<li>Press <code>Ctrl + D<\/code> (no prompt). It will ask you to confirm, then the system will revert its state and enable Developer Mode.<\/li>\n<\/ol>\n<div><strong> Note: <\/strong>Press <code>Ctrl + D<\/code> (or wait 30 seconds for the beep and boot) at the white boot splash screen to enter Chrome OS.<\/div>\n<p><\/p>\n<h3><span id=\"Accessing_the_superuser_shell\" class=\"mw-headline\">Accessing the superuser shell<\/span><\/h3>\n<p>Start a terminal session. There are two ways to start a terminal session in Chrome OS (in dev-mode): VT-2 or crosh. For our purposes here it does not matter which way is used.<br \/>\n<br \/>\n<span class=\"collapseomatic \" id=\"id6362925484ce6\"  tabindex=\"0\" title=\"Get the command prompt through VT-2\"    >Get the command prompt through VT-2<\/span><div id=\"target-id6362925484ce6\" class=\"collapseomatic_content \">\n<blockquote>\n<h4>Get the command prompt through VT-2<\/h4>\n<p>One way to get the login prompt is through something called VT-2, or &#8220;virtual terminal 2&#8221;. This is probably familiar to the Linux hackers out there. You can get to VT-2 by pressing:<\/p>\n<div>[ Ctrl ] [ Alt ] [ =&gt; ]<\/div>\n<p>&#8230;where the [ =&gt; ] key is the right-arrow key just above the number 3 on your keyboard.<\/p>\n<p>Once you have the login prompt, you should see a set of instructions telling you about command-line access. <span style=\"color: #ff0000;\">By default, you can login as the <\/span><code style=\"color: #38761d;\">chronos<\/code><span style=\"color: #ff0000;\"> user with no password. This includes the ability to do password-less sudo.<\/span> The instructions on the screen will tell you how you can set a password. They also tell you how to disable screen dimming.<\/p>\n<div>The instructions do tell you how to get back to the browser, but because it&#8217;s so important, I&#8217;ll also put it here. Just press:<\/div>\n<blockquote style=\"margin: 0px 0px 0px 40px; border-style: none; padding: 0px;\">\n<div>\n<div>[ Ctrl ] [ Alt ] [ &lt;= ]<\/div>\n<\/div>\n<\/blockquote>\n<div>&#8230;where the [ &lt;= ] key is the left-arrow key just above the number 1 on your keyboard.<\/div>\n<p><b>SIDE NOTE<\/b>: For the technical-minded, you may realize that the top-rows of the keyboard on a Chrome OS device are actually treated by Linux as the keys F1 through F10. Thus, the [ =&gt; ] key is actually F2 and the [ &lt;= ] key is actually F1.<\/p>\n<p><b>SIDE NOTE<\/b>: If you&#8217;re fooling around, you might also notice that kernel messages show up on VT-8.<\/p>\n<hr \/>\n<\/div>\n<span class=\"collapseomatic \" id=\"id6362925484d2f\"  tabindex=\"0\" title=\"Getting the command prompt through crosh\"    >Getting the command prompt through crosh<\/span><div id=\"target-id6362925484d2f\" class=\"collapseomatic_content \">\n<h4>Getting the command prompt through crosh<\/h4>\n<div>Because you booted into developer mode, you also have an alternate way to get a terminal prompt. I&#8217;ll mention this as well, since the alternate shell is a little nicer (in the very least, it keeps your screen from dimming on you), even if it is a little harder to get to. To use this alternate way:<\/div>\n<div>\n<ol style=\"list-style-type: decimal;\">\n<li>Go through the standard Chrome OS login screen (you&#8217;ll need to setup a network, etc) and get to the web browser. It&#8217;s OK if you login as guest.<\/li>\n<li>Press [ Ctrl ] [ Alt ] [ T ] to get the crosh shell.<\/li>\n<li>Use the <code style=\"color: #006000;\">shell<\/code> command to get the shell prompt. NOTE: even if you set a password for the <code>chronos<\/code> user, you won&#8217;t need it here (though you still need it for <code>sudo<\/code> access)<\/li>\n<\/ol>\n<\/div>\n<p>Note that entering the shell this way doesn&#8217;t give you all the instructions that VT-2 does (like how to set your password). You might want to follow the VT-2 steps once just to get the instructions.<\/p>\n<p>If you want to get back to the browser without killing the shell, you can do it with [ Alt ] [ Tab ].<\/p>\n<p><b>SIDE NOTE<\/b>: You can actually create as many shells as you want. Just hit [ Ctrl ] [ Alt ] [ T ] again and a second shell will be opened. You can [ Alt ] [ Tab ] between them.<\/p><\/blockquote>\n<\/div>\n<p>&nbsp;<\/p>\n<p>In the terminal open a bash shell with the <code>shell<\/code> command. Then become superuser with <code>sudo bash<\/code>.<\/p>\n<h3><span id=\"Enabling_SeaBIOS\" class=\"mw-headline\">Enabling SeaBIOS<\/span><\/h3>\n<p>This method will allow you to access the pre-installed version of SeaBIOS through the Developer Mode screen in Coreboot.<\/p>\n<ul>\n<li>Inside your superuser shell enter:<\/li>\n<\/ul>\n<p><code>crossystem dev_boot_usb=1 dev_boot_legacy=1<\/code><\/p>\n<ul>\n<li>Reboot the machine.<\/li>\n<\/ul>\n<p>You can now start SeaBIOS by pressing <code>Ctrl + L<\/code> at the white boot splash screen.<\/p>\n<h3><span id=\"Boot_to_SeaBIOS_by_default\" class=\"mw-headline\">Boot to SeaBIOS by default<\/span><\/h3>\n<p>To boot SeaBIOS by default, you will need to run <a class=\"external text\" href=\"https:\/\/chromium.googlesource.com\/chromiumos\/platform\/vboot_reference\/+\/master\/scripts\/image_signing\/set_gbb_flags.sh\" rel=\"nofollow\"><code>set_gbb_flags.sh<\/code><\/a> in Chrome OS (already included in Chrome OS).<\/p>\n<div><strong> Note: <\/strong>It is a good idea to do this and have SeaBIOS boot by default even if you do not mind pressing <code>Ctrl + L<\/code> at boot. The reason being is if you do not set the GBB flags then your system might become corrupted on empty battery, Chrome OS will be forced to recover and you will lose your Linux installation on the internal storage.<\/div>\n<p><\/p>\n<div><strong> Warning: <\/strong>If you do not disable the write protection before setting the GBB flags you endanger wiping out the RW-LEGACY part of the firmware (i.e. SeaBIOS) and your system might not boot (should be recoverable with Chrome OS recovery media). Updated versions of <a class=\"external text\" href=\"https:\/\/chromium.googlesource.com\/chromiumos\/platform\/vboot_reference\/+\/master\/scripts\/image_signing\/set_gbb_flags.sh\" rel=\"nofollow\"><code>set_gbb_flags.sh<\/code><\/a> won&#8217;t let you set the GBB flags without disabling the write protection.<\/div>\n<p><\/p>\n<ul>\n<li>Disable the hardware write protection by removing screw 7 here: <a href=\"http:\/\/www.chromium.org\/_\/rsrc\/1381990807648\/chromium-os\/developer-information-for-chrome-os-devices\/acer-c720-chromebook\/c720-chromebook-annotated-innards.png\">http:\/\/www.chromium.org\/_\/rsrc\/1381990807648\/chromium-os\/developer-information-for-chrome-os-devices\/acer-c720-chromebook\/c720-chromebook-annotated-innards.png <\/a>Note: Putting the cover back on with just screw 6 in should be enough to boot and complete the rest of the needed steps before putting the write-protect screw back in.<\/li>\n<\/ul>\n<ul>\n<li>Boot and start a <a title=\"Chromebook\" href=\"https:\/\/wiki.archlinux.org\/index.php\/Chromebook#Accessing_the_superuser_shell\">superuser shell<\/a> and enter:<\/li>\n<\/ul>\n<p><code>sudo su<br \/>\n<\/code><\/p>\n<ul>\n<li>Disable the software write protection.<\/li>\n<\/ul>\n<p><code>flashrom --wp-disable<br \/>\n<\/code><\/p>\n<ul>\n<li>Check that write protection is disabled.<\/li>\n<\/ul>\n<p><code>flashrom --wp-status<br \/>\n<\/code><\/p>\n<ul>\n<li>Run <code>set_gbb_flags.sh<\/code> with no parameters.<\/li>\n<\/ul>\n<p><code>set_gbb_flags.sh<br \/>\n<\/code><\/p>\n<div><strong> Note: <\/strong>Recent versions of Chrome OS have moved the script to \/usr\/share\/vboot\/bin\/set_gbb_flags.sh which isn&#8217;t in $PATH by default.<\/div>\n<ul>\n<li>Make sure you get the following output.<\/li>\n<\/ul>\n<p><code>GBB_FLAG_DEV_SCREEN_SHORT_DELAY 0x00000001<br \/>\nGBB_FLAG_FORCE_DEV_SWITCH_ON 0x00000008<br \/>\nGBB_FLAG_FORCE_DEV_BOOT_LEGACY 0x00000080<br \/>\nGBB_FLAG_DEFAULT_DEV_BOOT_LEGACY 0x00000400<br \/>\n<\/code><\/p>\n<ul>\n<li>Now set SeaBIOS as default.<\/li>\n<\/ul>\n<p><code># set_gbb_flags.sh 0x489<br \/>\n<\/code><\/p>\n<ul>\n<li>Enable back the software write protection.<\/li>\n<\/ul>\n<p><code>flashrom --wp-enable<br \/>\n<\/code><br \/>\nYour Chromebook now will boot to SeaBIOS by default, at this point you should re-enable the hardware write protection by reinserting the write protect screw.<\/p>\n<h3>Prepare the Installation Media<\/h3>\n<p>Navigate and retrieve the latest Bodhi Linux ISO from here:<\/p>\n<p><a title=\"Bodhi Linux ISO\" href=\"http:\/\/sourceforge.net\/projects\/bodhilinux\/files\/?source=navbar\" target=\"_blank\">http:\/\/sourceforge.net\/projects\/bodhilinux\/files\/?source=navbar<\/a><\/p>\n<p>As of this writing the current one we want is: <a title=\"bodhi-3.0.0-chromebook-rc1.iso\" href=\"http:\/\/sourceforge.net\/projects\/bodhilinux\/files\/3.0.0-rc1\/bodhi-3.0.0-chromebook-rc1.iso\/download\" target=\"_blank\">bodhi-3.0.0-chromebook-rc1.iso<\/a><\/p>\n<p>Assuming we are preparing the installation media in a Linux environment, change to the directory where you have downloaded the ISO image to and run:<br \/>\n<code>dd if=bodhi-c720-chromebook-rc1.iso of=\/dev\/sdX<\/code><br \/>\nWhere X is replaced with the drive letter of your USB stick. A quick way to find this out is checking the output of the command <code>dmesg<\/code> after inserting the usb drive.<\/p>\n<p>If you prefer a GUI tool or are using OSX\/Windows to create the flash drive you can find detailed information on this process <a href=\"https:\/\/help.ubuntu.com\/community\/Installation\/FromImgFiles\" target=\"_blank\">here<\/a>.<\/p>\n<h3>Boot From the Installation Media and Install Bodhi Linux<\/h3>\n<p>Since we have set SeaBIOS to boot by default we will not need to press <code>Ctrl + L<\/code> at the white boot splash screen.<\/p>\n<p>A message will appear to press the <code>ESC<\/code> key to select to bring up the boot menu, proceed to do so and select your USB device from the list it provides.<\/p>\n<p>From this point you can follow the <a href=\"http:\/\/wiki.bodhilinux.com\/doku.php?id=installation_instructions#iiboot_into_the_live_environment\" target=\"_blank\">normal Bodhi install instructions<\/a>.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Situation: We have an Acer C720 Chromebook and want Chrome OS removed and Bodhi Linux installed on it. Additionally we want to have it boot to Linux by default without having to start SeaBIOS manually by pressing Ctrl + L at the white boot splash screen. Objective: Acer C720 Chromebook with Chrome OS removed and [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_genesis_hide_title":false,"_genesis_hide_breadcrumbs":false,"_genesis_hide_singular_image":false,"_genesis_hide_footer_widgets":false,"_genesis_custom_body_class":"","_genesis_custom_post_class":"","_genesis_layout":""},"categories":[1],"tags":[],"_links":{"self":[{"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/posts\/163"}],"collection":[{"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/comments?post=163"}],"version-history":[{"count":0,"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/posts\/163\/revisions"}],"wp:attachment":[{"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/media?parent=163"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/categories?post=163"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/www.codeapex.com\/wp-json\/wp\/v2\/tags?post=163"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}
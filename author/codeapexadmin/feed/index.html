<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Code Apex</title>
	<atom:link href="http://www.codeapex.com/author/codeapexadmin/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.codeapex.com</link>
	<description></description>
	<lastBuildDate>Sun, 29 Aug 2021 00:00:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.0.3</generator>
	<item>
		<title>Deleting Duplicate Rows In SQL</title>
		<link>http://www.codeapex.com/deleting-duplicate-rows-in-sql/</link>
					<comments>http://www.codeapex.com/deleting-duplicate-rows-in-sql/#respond</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Mon, 26 Jul 2021 17:10:47 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">https://www.codeapex.com/?p=240</guid>

					<description><![CDATA[Situation: There is a table in our SQL database which contains rows which we consider duplicate based upon the values in some or all of the columns. We wish to delete these duplicate rows. Objective: To demonstrate and explain a short memorable method of deleting duplicate rows in a SQL database table using a common [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>There is a table in our SQL database which contains rows which we consider duplicate based upon the values in some or all of the columns.</p>
<p>We wish to delete these duplicate rows.</p>
<h2>Objective:</h2>
<p>To demonstrate and explain a short memorable method of deleting duplicate rows in a SQL database table using a common table expression and a window function.</p>
<p>Specifically if columns <code>[col1],[col2],[col5]</code> define uniqueness for some table, say <code>dbo.Table</code>, the following query will delete duplicates:</p>
<p><code>;WITH CTE AS(<br />
SELECT ROW_NUMBER()OVER(PARTITION BY col1, col2, col5 ORDER BY col1, col2, col5) AS RN<br />
FROM dbo.Table<br />
)<br />
DELETE FROM CTE WHERE RN &gt; 1</code></p>
<h2>Plan:</h2>
<p>First we define which columns being the same between rows implies the rows are duplicate or in other words what columns taken together we want unique across the table.</p>
<p>Next we partition and enumerate each set of unique rows using a common table expression (CTE) and the window function <code>ROW_NUMBER()OVER()</code>.</p>
<p>What this means is we are partitioning the rows into sets of the same row and for each partition assigning a 1 to the first row in the partition, 2 to the next row in the partition, 3 in the next row in the partition, and so on; call this number RN.</p>
<p>Then we delete all such rows where the row number is greater than 1 (RN &gt; 1).</p>
<h2>Execution:</h2>
<p><strong>Example Table:</strong> <code>dbo.Table</code></p>
<table class="sqloutput">
<tbody>
<tr>
<th></th>
<th>col1</th>
<th>col2</th>
<th>col3</th>
<th>col4</th>
<th>col5</th>
</tr>
<tr>
<td>1</td>
<td>Alpha</td>
<td>1</td>
<td>1</td>
<td>CO</td>
<td>42</td>
</tr>
<tr>
<td>2</td>
<td>Alpha</td>
<td>1</td>
<td>1</td>
<td>CO</td>
<td>42</td>
</tr>
<tr>
<td>3</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>29</td>
</tr>
<tr>
<td>4</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>29</td>
</tr>
<tr>
<td>5</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>37</td>
</tr>
</tbody>
</table>
<p><strong>Define uniqueness / duplicate:</strong></p>
<p>Let&#8217;s say a certain set of columns from the table taken together should be unique across the table; say columns <code>[col1],[col2],[col5]</code>.</p>
<p><strong>Enumeration / CTE part of query:</strong></p>
<p>We create a CTE for our table that partitions the rows into sets of the same row and enumerates each partition.</p>
<p>The result of the CTE should look like this:</p>
<table class="sqloutput">
<tbody>
<tr>
<th></th>
<th>col1</th>
<th>col2</th>
<th>col3</th>
<th>col4</th>
<th>col5</th>
<th>RN</th>
</tr>
<tr>
<td>1</td>
<td>Alpha</td>
<td>1</td>
<td>1</td>
<td>CO</td>
<td>42</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>Alpha</td>
<td>1</td>
<td>1</td>
<td>CO</td>
<td>42</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>29</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>29</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>37</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>A CTE that accomplishes this is:</p>
<p><code>;WITH CTE AS(<br />
SELECT col1, col2, col5,<br />
ROW_NUMBER()OVER(PARTITION BY col1, col2, col5 ORDER BY col1, col2, col5) AS RN<br />
FROM dbo.Table<br />
)</code></p>
<p>The key part is we PARTITION BY the columns that define uniqueness.</p>
<p><strong>Deletion part of query:</strong></p>
<p>Using our CTE we delete the rows from the table where RN &gt; 1 as such rows are duplicate.</p>
<p><code>DELETE FROM CTE WHERE RN &gt; 1</code></p>
<p><strong>Result:</strong></p>
<p>After deletion our example table would look like this:</p>
<table class="sqloutput">
<tbody>
<tr>
<th></th>
<th>col1</th>
<th>col2</th>
<th>col3</th>
<th>col4</th>
<th>col5</th>
</tr>
<tr>
<td>1</td>
<td>Alpha</td>
<td>1</td>
<td>1</td>
<td>CO</td>
<td>42</td>
</tr>
<tr>
<td>2</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>29</td>
</tr>
<tr>
<td>3</td>
<td>Beta</td>
<td>2</td>
<td>2</td>
<td>MN</td>
<td>37</td>
</tr>
</tbody>
</table>
<h2>Conclusion:</h2>
<p>For the CTE some of the columns in the SELECT portion are optional and were included for illustrative purposes only.</p>
<p>Specifically only the RN column is needed since the DELETE statement only works with RN.</p>
<p>Consequently the others can be dropped from the query without altering the end result giving us our final query:</p>
<p><strong>Final query:</strong></p>
<p><code>;WITH CTE AS(<br />
SELECT ROW_NUMBER()OVER(PARTITION BY col1, col2, col5 ORDER BY col1, col2, col5) AS RN<br />
FROM dbo.Table<br />
)<br />
DELETE FROM CTE WHERE RN &gt; 1</code></p>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/deleting-duplicate-rows-in-sql/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Increasing Linux VPS RAM for Free Using ZRAM &#8211; udev rule</title>
		<link>http://www.codeapex.com/increasing-linux-vps-ram-for-free-using-zram-udev-rule/</link>
					<comments>http://www.codeapex.com/increasing-linux-vps-ram-for-free-using-zram-udev-rule/#respond</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Tue, 12 Jan 2021 23:08:10 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">http://www.codeapex.com/?p=204</guid>

					<description><![CDATA[Situation: You are reaching or exceeding the RAM limits of your Linux VPS. Objective: An increase in the amount of non-virtualized memory available to your applications on your VPS without resorting to paying for an upgraded VPS. Plan + Execution: Note we want an increase in the amount of fast physical memory available to our [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>You are reaching or exceeding the RAM limits of your Linux VPS.</p>
<h2>Objective:</h2>
<p>An increase in the amount of non-virtualized memory available to your applications on your VPS without resorting to paying for an upgraded VPS.</p>
<h2>Plan + Execution:</h2>
<p><span id="more-204"></span></p>
<p>Note we want an increase in the amount of fast physical memory available to our applications. Increasing virtualized memory (via an increase in swap partition or swap file sizes) would not meet our objective; though if your VPS is on SSDs then upping swap space may not be a bad option since solid state disks are substantially faster than traditional hard disks (but still not as fast as physical memory).</p>
<p>One way of making more physical memory available to your applications is to be more efficient with the use of the RAM available. We can accomplish this by compressing data stored in memory; specifically we will use <a title="ZRAM Wikipedia" href="http://en.wikipedia.org/wiki/Zram" target="_blank" rel="noopener">ZRAM</a> to appropriate a percentage of total RAM as compressed block devices. Data stored in the area will be compressed and will take up less memory than if they weren&#8217;t.</p>
<p>Realize though that ZRAM will put a little more load on the CPU since it now has to compress/decompress data in that portion. So if you also reaching or exceeding the CPU limits of your VPS you should do testing to see if ZRAM helps your situation or perhaps consider actually upgrading your VPS.</p>
<p>Note some commands listed below may require superuser priviledges. Either</p>
<ol>
<li>use the <code>su</code> command to change the login session&#8217;s owner to root; or</li>
<li>prepend the commands with <code>sudo</code> (e.g. <code>sudo swapon -s</code>); or</li>
<li>login as root directly</li>
</ol>
<h3>Checking Kernel Support:</h3>
<p>In a terminal run this command:<br />
<code>modprobe -nv zram</code></p>
<p>If the result is a path to zram.ko then your kernel supports zram as a loadable module.</p>
<h3>Checking if ZRAM is Already Enabled:</h3>
<p>Some distributions come with ZRAM enabled by default (such as Lubuntu). Before continuing onward we should double check to ensure we are not trying to accomplish something that is already done.<br />
Check to see if the module is loaded:<br />
<code>lsmod | grep zram</code></p>
<p>If it is loaded (the result is a line starting with zram) check to see if the compressed block devices are setup and running as available swap devices:<br />
<code>swapon -s</code></p>
<p>If you see devices listed such as /dev/zram0, /dev/zram1,&#8230; then ZRAM is already running and there is nothing you need to do further.</p>
<h3>Creating the udev rule</h3>
<p>Enable the module:<br />
/etc/modules-load.d/zram.conf<br />
<code>zram</code></p>
<p>Configure the number of /dev/zram nodes you need.<br />
/etc/modprobe.d/zram.conf<br />
<code>options zram num_devices=2</code></p>
<p>Create the udev rule as shown in the example.<br />
/etc/udev/rules.d/99-zram.rules<br />
<code>KERNEL=="zram0", ATTR{disksize}="512M" RUN="/sbin/mkswap /dev/zram0", TAG+="systemd"<br />
KERNEL=="zram1", ATTR{disksize}="512M" RUN="/sbin/mkswap /dev/zram1", TAG+="systemd"</code></p>
<p>Add /dev/zram to your fstab.<br />
/etc/fstab<br />
<code>/dev/zram0 none swap sw 0 0<br />
/dev/zram1 none swap sw 0 0</code></p>
<p>As for how large should the zram devices be in total depends on the kind of workload, note the following comment from one of ZRAM&#8217;s developers (back when it was known as Compcache): <a title="ZRAM (Compcache) Nitin Gupta Comment" href="https://code.google.com/p/compcache/wiki/CompilingAndUsingNew">https://code.google.com/p/compcache/wiki/CompilingAndUsingNew</a></p>
<blockquote><p><span class="author">Comment by project member <a class="userlink" href="https://code.google.com/u/nitingupta910@gmail.com/">nitingupta910@gmail.com</a>, </span> <span class="date" title="Fri May 7 01:35:52 2010">May 7, 2010</span></p>
<p>@Paczesiowa: ramzswap should not be given so much of memory as its just a (virtual) swap device &#8212; it can compress only anonymous (say, process stack, heap etc.) memory. There are also other kinds of caches in the system, say filesystem cache which also require lot of memory. So, to have a good balance among all the different caches, ramzswap should not be given nearly 100% of RAM.</p>
<p>Appropriate amount of ramzswap memory depends on kind of workload. For typical desktop workloads, I found 25% to work just fine (this is the default).</p></blockquote>
<h3>Reboot:</h3>
<p>Reboot.</p>
<h3>Verify:</h3>
<p>Verify that the module is loaded:<br />
<code>lsmod | grep zram</code></p>
<p>If the result is a line starting with zram then it is loaded.</p>
<p>Verify that the compressed block devices are setup and running as available swap devices:<br />
<code>swapon -s</code></p>
<p>If you see devices listed such as /dev/zram0, /dev/zram1,&#8230; then the compressed block devices are enabled as swap devices and the setup of ZRAM is complete.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/increasing-linux-vps-ram-for-free-using-zram-udev-rule/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Installing Bodhi Linux on an Acer C720 Chromebook with SeaBIOS as default.</title>
		<link>http://www.codeapex.com/installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default/</link>
					<comments>http://www.codeapex.com/installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default/#comments</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Mon, 15 Dec 2014 18:59:22 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">http://www.codeapex.com/?p=163</guid>

					<description><![CDATA[Situation: We have an Acer C720 Chromebook and want Chrome OS removed and Bodhi Linux installed on it. Additionally we want to have it boot to Linux by default without having to start SeaBIOS manually by pressing Ctrl + L at the white boot splash screen. Objective: Acer C720 Chromebook with Chrome OS removed and [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>We have an Acer C720 Chromebook and want Chrome OS removed and Bodhi Linux installed on it. Additionally we want to have it boot to Linux by default without having to start SeaBIOS manually by pressing <code>Ctrl + L</code> at the white boot splash screen.</p>
<h2>Objective:</h2>
<p>Acer C720 Chromebook with Chrome OS removed and Bodhi Linux installed with SeaBIOS booting by default.</p>
<h2>Plan + Execution:</h2>
<h3>Outline</h3>
<p>The general installation procedure:</p>
<ol>
<li>Enable developer mode to allow access to the superuser shell in Chrome OS.</li>
<li>Accessing the superuser shell.</li>
<li>Enable legacy boot / SeaBIOS.</li>
<li>Set SeaBIOS as default.</li>
<li>Prepare the installation media (USB stick).</li>
<li>Boot from the installation media and install Bodhi Linux.</li>
</ol>
<h3><span id="Enabling_Developer_Mode" class="mw-headline">Enabling Developer Mode</span></h3>
<ol>
<li>Turn on the Chromebook.</li>
<li>Press and hold the <code>Esc + F3 (Refresh)</code> keys, then press the <code>Power</code> button. This enters Recovery Mode.</li>
<li>Press <code>Ctrl + D</code> (no prompt). It will ask you to confirm, then the system will revert its state and enable Developer Mode.</li>
</ol>
<div><strong> Note: </strong>Press <code>Ctrl + D</code> (or wait 30 seconds for the beep and boot) at the white boot splash screen to enter Chrome OS.</div>
<p></p>
<h3><span id="Accessing_the_superuser_shell" class="mw-headline">Accessing the superuser shell</span></h3>
<p>Start a terminal session. There are two ways to start a terminal session in Chrome OS (in dev-mode): VT-2 or crosh. For our purposes here it does not matter which way is used.<br />
<br />
<span class="collapseomatic " id="id63629251e9286"  tabindex="0" title="Get the command prompt through VT-2"    >Get the command prompt through VT-2</span><div id="target-id63629251e9286" class="collapseomatic_content ">
<blockquote>
<h4>Get the command prompt through VT-2</h4>
<p>One way to get the login prompt is through something called VT-2, or &#8220;virtual terminal 2&#8221;. This is probably familiar to the Linux hackers out there. You can get to VT-2 by pressing:</p>
<div>[ Ctrl ] [ Alt ] [ =&gt; ]</div>
<p>&#8230;where the [ =&gt; ] key is the right-arrow key just above the number 3 on your keyboard.</p>
<p>Once you have the login prompt, you should see a set of instructions telling you about command-line access. <span style="color: #ff0000;">By default, you can login as the </span><code style="color: #38761d;">chronos</code><span style="color: #ff0000;"> user with no password. This includes the ability to do password-less sudo.</span> The instructions on the screen will tell you how you can set a password. They also tell you how to disable screen dimming.</p>
<div>The instructions do tell you how to get back to the browser, but because it&#8217;s so important, I&#8217;ll also put it here. Just press:</div>
<blockquote style="margin: 0px 0px 0px 40px; border-style: none; padding: 0px;">
<div>
<div>[ Ctrl ] [ Alt ] [ &lt;= ]</div>
</div>
</blockquote>
<div>&#8230;where the [ &lt;= ] key is the left-arrow key just above the number 1 on your keyboard.</div>
<p><b>SIDE NOTE</b>: For the technical-minded, you may realize that the top-rows of the keyboard on a Chrome OS device are actually treated by Linux as the keys F1 through F10. Thus, the [ =&gt; ] key is actually F2 and the [ &lt;= ] key is actually F1.</p>
<p><b>SIDE NOTE</b>: If you&#8217;re fooling around, you might also notice that kernel messages show up on VT-8.</p>
<hr />
</div>
<span class="collapseomatic " id="id63629251e92cf"  tabindex="0" title="Getting the command prompt through crosh"    >Getting the command prompt through crosh</span><div id="target-id63629251e92cf" class="collapseomatic_content ">
<h4>Getting the command prompt through crosh</h4>
<div>Because you booted into developer mode, you also have an alternate way to get a terminal prompt. I&#8217;ll mention this as well, since the alternate shell is a little nicer (in the very least, it keeps your screen from dimming on you), even if it is a little harder to get to. To use this alternate way:</div>
<div>
<ol style="list-style-type: decimal;">
<li>Go through the standard Chrome OS login screen (you&#8217;ll need to setup a network, etc) and get to the web browser. It&#8217;s OK if you login as guest.</li>
<li>Press [ Ctrl ] [ Alt ] [ T ] to get the crosh shell.</li>
<li>Use the <code style="color: #006000;">shell</code> command to get the shell prompt. NOTE: even if you set a password for the <code>chronos</code> user, you won&#8217;t need it here (though you still need it for <code>sudo</code> access)</li>
</ol>
</div>
<p>Note that entering the shell this way doesn&#8217;t give you all the instructions that VT-2 does (like how to set your password). You might want to follow the VT-2 steps once just to get the instructions.</p>
<p>If you want to get back to the browser without killing the shell, you can do it with [ Alt ] [ Tab ].</p>
<p><b>SIDE NOTE</b>: You can actually create as many shells as you want. Just hit [ Ctrl ] [ Alt ] [ T ] again and a second shell will be opened. You can [ Alt ] [ Tab ] between them.</p></blockquote>
</div>
<p>&nbsp;</p>
<p>In the terminal open a bash shell with the <code>shell</code> command. Then become superuser with <code>sudo bash</code>.</p>
<h3><span id="Enabling_SeaBIOS" class="mw-headline">Enabling SeaBIOS</span></h3>
<p>This method will allow you to access the pre-installed version of SeaBIOS through the Developer Mode screen in Coreboot.</p>
<ul>
<li>Inside your superuser shell enter:</li>
</ul>
<p><code>crossystem dev_boot_usb=1 dev_boot_legacy=1</code></p>
<ul>
<li>Reboot the machine.</li>
</ul>
<p>You can now start SeaBIOS by pressing <code>Ctrl + L</code> at the white boot splash screen.</p>
<h3><span id="Boot_to_SeaBIOS_by_default" class="mw-headline">Boot to SeaBIOS by default</span></h3>
<p>To boot SeaBIOS by default, you will need to run <a class="external text" href="https://chromium.googlesource.com/chromiumos/platform/vboot_reference/+/master/scripts/image_signing/set_gbb_flags.sh" rel="nofollow"><code>set_gbb_flags.sh</code></a> in Chrome OS (already included in Chrome OS).</p>
<div><strong> Note: </strong>It is a good idea to do this and have SeaBIOS boot by default even if you do not mind pressing <code>Ctrl + L</code> at boot. The reason being is if you do not set the GBB flags then your system might become corrupted on empty battery, Chrome OS will be forced to recover and you will lose your Linux installation on the internal storage.</div>
<p></p>
<div><strong> Warning: </strong>If you do not disable the write protection before setting the GBB flags you endanger wiping out the RW-LEGACY part of the firmware (i.e. SeaBIOS) and your system might not boot (should be recoverable with Chrome OS recovery media). Updated versions of <a class="external text" href="https://chromium.googlesource.com/chromiumos/platform/vboot_reference/+/master/scripts/image_signing/set_gbb_flags.sh" rel="nofollow"><code>set_gbb_flags.sh</code></a> won&#8217;t let you set the GBB flags without disabling the write protection.</div>
<p></p>
<ul>
<li>Disable the hardware write protection by removing screw 7 here: <a href="http://www.chromium.org/_/rsrc/1381990807648/chromium-os/developer-information-for-chrome-os-devices/acer-c720-chromebook/c720-chromebook-annotated-innards.png">http://www.chromium.org/_/rsrc/1381990807648/chromium-os/developer-information-for-chrome-os-devices/acer-c720-chromebook/c720-chromebook-annotated-innards.png </a>Note: Putting the cover back on with just screw 6 in should be enough to boot and complete the rest of the needed steps before putting the write-protect screw back in.</li>
</ul>
<ul>
<li>Boot and start a <a title="Chromebook" href="https://wiki.archlinux.org/index.php/Chromebook#Accessing_the_superuser_shell">superuser shell</a> and enter:</li>
</ul>
<p><code>sudo su<br />
</code></p>
<ul>
<li>Disable the software write protection.</li>
</ul>
<p><code>flashrom --wp-disable<br />
</code></p>
<ul>
<li>Check that write protection is disabled.</li>
</ul>
<p><code>flashrom --wp-status<br />
</code></p>
<ul>
<li>Run <code>set_gbb_flags.sh</code> with no parameters.</li>
</ul>
<p><code>set_gbb_flags.sh<br />
</code></p>
<div><strong> Note: </strong>Recent versions of Chrome OS have moved the script to /usr/share/vboot/bin/set_gbb_flags.sh which isn&#8217;t in $PATH by default.</div>
<ul>
<li>Make sure you get the following output.</li>
</ul>
<p><code>GBB_FLAG_DEV_SCREEN_SHORT_DELAY 0x00000001<br />
GBB_FLAG_FORCE_DEV_SWITCH_ON 0x00000008<br />
GBB_FLAG_FORCE_DEV_BOOT_LEGACY 0x00000080<br />
GBB_FLAG_DEFAULT_DEV_BOOT_LEGACY 0x00000400<br />
</code></p>
<ul>
<li>Now set SeaBIOS as default.</li>
</ul>
<p><code># set_gbb_flags.sh 0x489<br />
</code></p>
<ul>
<li>Enable back the software write protection.</li>
</ul>
<p><code>flashrom --wp-enable<br />
</code><br />
Your Chromebook now will boot to SeaBIOS by default, at this point you should re-enable the hardware write protection by reinserting the write protect screw.</p>
<h3>Prepare the Installation Media</h3>
<p>Navigate and retrieve the latest Bodhi Linux ISO from here:</p>
<p><a title="Bodhi Linux ISO" href="http://sourceforge.net/projects/bodhilinux/files/?source=navbar" target="_blank">http://sourceforge.net/projects/bodhilinux/files/?source=navbar</a></p>
<p>As of this writing the current one we want is: <a title="bodhi-3.0.0-chromebook-rc1.iso" href="http://sourceforge.net/projects/bodhilinux/files/3.0.0-rc1/bodhi-3.0.0-chromebook-rc1.iso/download" target="_blank">bodhi-3.0.0-chromebook-rc1.iso</a></p>
<p>Assuming we are preparing the installation media in a Linux environment, change to the directory where you have downloaded the ISO image to and run:<br />
<code>dd if=bodhi-c720-chromebook-rc1.iso of=/dev/sdX</code><br />
Where X is replaced with the drive letter of your USB stick. A quick way to find this out is checking the output of the command <code>dmesg</code> after inserting the usb drive.</p>
<p>If you prefer a GUI tool or are using OSX/Windows to create the flash drive you can find detailed information on this process <a href="https://help.ubuntu.com/community/Installation/FromImgFiles" target="_blank">here</a>.</p>
<h3>Boot From the Installation Media and Install Bodhi Linux</h3>
<p>Since we have set SeaBIOS to boot by default we will not need to press <code>Ctrl + L</code> at the white boot splash screen.</p>
<p>A message will appear to press the <code>ESC</code> key to select to bring up the boot menu, proceed to do so and select your USB device from the list it provides.</p>
<p>From this point you can follow the <a href="http://wiki.bodhilinux.com/doku.php?id=installation_instructions#iiboot_into_the_live_environment" target="_blank">normal Bodhi install instructions</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>Encrypting Data on a Linux VPS &#8211; LUKS Encrypted Volume via File Method</title>
		<link>http://www.codeapex.com/encrypting-data-on-a-linux-vps-luks-encrypted-volume-via-file-method/</link>
					<comments>http://www.codeapex.com/encrypting-data-on-a-linux-vps-luks-encrypted-volume-via-file-method/#respond</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Thu, 11 Sep 2014 21:25:02 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">http://www.codeapex.com/?p=87</guid>

					<description><![CDATA[Situation: You wish to have certain files encrypted on your VPS and you do not want to repartition to accommodate an encrypted volume on a partition or logical volume. Objective: A mountable LUKS encrypted volume based on a file in the filesystem. Plan + Execution: Install cryptsetup: If cryptsetup is not installed already, use the [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>You wish to have certain files encrypted on your VPS and you do not want to repartition to accommodate an encrypted volume on a partition or logical volume.</p>
<h2>Objective:</h2>
<p>A mountable LUKS encrypted volume based on a file in the filesystem.</p>
<h2>Plan + Execution:</h2>
<h3>Install cryptsetup:</h3>
<p>If cryptsetup is not installed already, use the appropriate command to install it for your distro.</p>
<p>Debian based:<br />
<code>apt-get install cryptsetup</code></p>
<h3>Create Encrypted Volume File:</h3>
<p>An empty non-sparse file is needed to serve as the encrypted volume. We will create such a file of 1G in size named enc-vol-1G at the root level directory, feel free to substitute your own size, name and location preferences for this file; the same goes for any arbitrary naming used here.</p>
<p>Note we need a non-sparse file meaning the full 1G space has been allocated for the file by the filesystem, so we cannot just use the <code>touch</code> command to create the file; our options are either the <code>fallocate</code> or <code>dd</code> commands. For creating the file <code>fallocate</code> is faster but <code>dd</code> offers more features, prefilling the allocated space with pseudo-random data using <code>if=/dev/urandom</code> for instance.</p>
<p><code>fallocate -l 1GB /enc-vol-1G</code><br />
or<br />
<code>dd if=/dev/zero of=/enc-vol-1G bs=1M count=1024</code></p>
<h3>Transform File into a LUKS Partition with a Filesystem:</h3>
<p>Turn the File Into a LUKS Partition:<br />
<code>cryptsetup -y luksFormat /enc-vol-1G</code></p>
<p>Open the LUKS Partition and Setup Mapping Name:<br />
<code>cryptsetup luksOpen /enc-vol-1G encrypted_volume</code></p>
<p>The mapping name is arbitrary and in our case we chose &#8220;encrypted_volume&#8221;. After running the command a new device is created: <code>/dev/mapper/encrypted_volume</code> which we can treat in a similar manner as one would a disk partition.</p>
<p>Create a Filesystem on the LUKS Partition:<br />
<code>mke2fs -t ext4 /dev/mapper/encrypted_volume</code></p>
<p>Close the LUKS Partition Releasing the Mapping Name  and Clearing Key from Kernel Memory:<br />
<code>cryptsetup luksClose encrypted_volume</code></p>
<p>Create a Mount Point:<br />
<code>mkdir /mnt/secret_stuff</code></p>
<p>Mount point name and location are arbitrary; customize per your needs.</p>
<p>At this point our objective is met and we have a mountable LUKS encrypted volume based on a file in the filesystem.</p>
<h3>How to use:</h3>
<p>Opening the LUKS partition:<br />
<code>cryptsetup luksOpen /enc-vol-1G encrypted_volume</code></p>
<p>Mounting the Encrypted Volume:<br />
<code>mount /dev/mapper/encrypted_volume /mnt/secret_stuff</code></p>
<p>Anything you now copy to /mnt/secret_stuff will be encrypted.</p>
<p>Examples:<br />
<code>cp secret_file1.txt /mnt/secret_stuff</code></p>
<p><code>cp -R secret_dir /mnt/secret_stuff</code></p>
<p>Unmounting:<br />
<code>umount /mnt/secret_stuff</code></p>
<p>Closing the LUKS Partition:<br />
<code>cryptsetup luksClose encrypted_volume</code></p>
<h3>Notes on Security:</h3>
<p>Remember this maxim: Physical Access = Root Access</p>
<p>If someone has physical access to a machine they essentially can get root access.</p>
<p>This is more crucial to note when using a VPS. Not only do the operators of the physical server hosting your VPS have &#8220;physical&#8221; access to your VPS but so does anyone who hacks the actual machine your VPS is on.</p>
<p>While a LUKS partition is open the decryption key is stored in the kernel memory. A skilled person with root access can look for the key in memory or if they have &#8220;physical&#8221; access to the VPS they can just take a snapshot running state image of the VPS and pull the key from the snapshot.</p>
<p>Essentially what this means is there is a small chance someone could get the encryption key for the encrypted volume while it is unlocked on the VPS.</p>
<p>With that said a LUKS encrypted volume provides protection in the following scenarios assuming the LUKS partition is not currently open during them:</p>
<ol>
<li>The VPS itself is hacked by an intruder who gains root access. Even though the intruder has root access on the VPS they do not have the key to open the encrypted volume (<small>technically though if no one noticed the intrusion they could potentially leave some hidden process to patiently wait for the encrypted volume to be opened to grab the key then</small>).</li>
<li>The physical server hosting the VPS is hacked by an intruder who copies all the data from the physical server offsite before getting found and blocked. This data includes all the data on your VPS&#8217;s hard disk (and RAM if an intruder took a snapshot of your running VPS) at the time the data was copied; but since the LUKS encrypted volume was closed at the time and the key not in your VPS&#8217;s RAM, the intruder will not be able to access the data in the encrypted volume in their copy of your VPS data.</li>
</ol>
<p>With that said data stored in a LUKS encrypted volume is more secure than otherwise due to the additional hurdles an intruder would have to navigate to even get a chance to access the data.</p>
<h2>Misc Tips:</h2>
<h3>Multiple Passphrases:</h3>
<p>A LUKS device has 8 key slots that can be used for passphrases (or key files if one is inclined) to unlock it. Use the luksDump action of the cryptsetup command to to show the header information for the LUKS device and at the bottom will be information on the key slots.</p>
<p><code>cryptsetup luksDump /enc-vol-1G</code></p>
<p>output snippet with key slot information:</p>
<pre class="lang:default decode:true">Key Slot 0: ENABLED
Iterations:             130398
Salt:                   dc 66 3b 57 8b 70 29 d2 ad 36 78 6c 88 01 65 81
98 df 17 7e 16 e6 76 46 d8 53 d7 40 ec a1 11 04
Key material offset:    8
AF stripes:             4000
Key Slot 1: DISABLED
Key Slot 2: DISABLED
Key Slot 3: DISABLED
Key Slot 4: DISABLED
Key Slot 5: DISABLED
Key Slot 6: DISABLED
Key Slot 7: DISABLED</pre>
<p>Key Slot 0 is currently being used for the passphrase we initially setup our LUKS device with. To add an additional passphrase:</p>
<p><code>cryptsetup luksAddKey /enc-vol-1G</code></p>
<p>You will be first asked to enter any passphrase that unlocks the volume, then you will be prompted to enter a new additional passphrase that can be used to unlock the volume. The passphrase will use the next available key slot, alternatively to use a specific key slot for the passphrase (ex. using key slot 7): <code>cryptsetup --key-slot 7 luksAddKey /enc-vol-1G</code></p>
<p>To remove a passphrase use the luksRemoveKey action of the cryptsetup command:</p>
<p><code>cryptsetup luksRemoveKey /enc-vol-1G</code></p>
<p>You will be prompted for the passphrase you want to remove. Alternatively to disable/remove a specific key slot (ex. remove key slot 7): <code>cryptsetup luksKillSlot /enc-vol-1G 7</code></p>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/encrypting-data-on-a-linux-vps-luks-encrypted-volume-via-file-method/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Increasing Linux VPS RAM for Free Using ZRAM &#8211; rc script</title>
		<link>http://www.codeapex.com/increasing-linux-vps-ram-for-free-zram-rcscript/</link>
					<comments>http://www.codeapex.com/increasing-linux-vps-ram-for-free-zram-rcscript/#respond</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Thu, 31 Jul 2014 18:03:29 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">http://www.codeapex.com/?p=56</guid>

					<description><![CDATA[Situation: You are reaching or exceeding the RAM limits of your Linux VPS. Objective: An increase in the amount of non-virtualized memory available to your applications on your VPS without resorting to paying for an upgraded VPS. Plan + Execution: Note we want an increase in the amount of fast physical memory available to our [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>You are reaching or exceeding the RAM limits of your Linux VPS.</p>
<h2>Objective:</h2>
<p>An increase in the amount of non-virtualized memory available to your applications on your VPS without resorting to paying for an upgraded VPS.</p>
<h2>Plan + Execution:</h2>
<p><span id="more-56"></span></p>
<p>Note we want an increase in the amount of fast physical memory available to our applications. Increasing virtualized memory (via an increase in swap partition or swap file sizes) would not meet our objective; though if your VPS is on SSDs then upping swap space may not be a bad option since solid state disks are substantially faster than traditional hard disks (but still not as fast as physical memory).</p>
<p>One way of making more physical memory available to your applications is to be more efficient with the use of the RAM available. We can accomplish this by compressing data stored in memory; specifically we will use <a title="ZRAM Wikipedia" href="http://en.wikipedia.org/wiki/Zram" target="_blank" rel="noopener">ZRAM</a> to appropriate a percentage of total RAM as compressed block devices. Data stored in the area will be compressed and will take up less memory than if they weren&#8217;t.</p>
<p>Realize though that ZRAM will put a little more load on the CPU since it now has to compress/decompress data in that portion. So if you also reaching or exceeding the CPU limits of your VPS you should do testing to see if ZRAM helps your situation or perhaps consider actually upgrading your VPS.</p>
<p>Note some commands listed below may require superuser priviledges. Either</p>
<ol>
<li>use the <code>su</code> command to change the login session&#8217;s owner to root; or</li>
<li>prepend the commands with <code>sudo</code> (e.g. <code>sudo swapon -s</code>); or</li>
<li>login as root directly</li>
</ol>
<h3>Checking Kernel Support:</h3>
<p>In a terminal run this command:<br />
<code>modprobe -nv zram</code></p>
<p>If the result is a path to zram.ko then your kernel supports zram as a loadable module.</p>
<h3>Checking if ZRAM is Already Enabled:</h3>
<p>Some distributions come with ZRAM enabled by default (such as Lubuntu). Before continuing onward we should double check to ensure we are not trying to accomplish something that is already done.<br />
Check to see if the module is loaded:<br />
<code>lsmod | grep zram</code></p>
<p>If it is loaded (the result is a line starting with zram) check to see if the compressed block devices are setup and running as available swap devices:<br />
<code>swapon -s</code></p>
<p>If you see devices listed such as /dev/zram0, /dev/zram1,&#8230; then ZRAM is already running and there is nothing you need to do further.</p>
<h3>Creating the Startup Script:</h3>
<p>If it does not already exist create the file <strong>/etc/init.d/zram</strong> with the following contents:</p>
<pre class="lang:sh decode:true" title="zram">#!/bin/bash
### BEGIN INIT INFO
# Provides: zram
# Required-Start:
# Required-Stop:
# Default-Start: 2 3 4 5
# Default-Stop: 0 1 6
# Short-Description: Increased Performance In Linux With zRam (Virtual Swap Compressed in RAM)
# Description: Adapted from systemd scripts at https://github.com/mystilleef/FedoraZram
# Included as part of antix-goodies package by anticapitalista &lt;antiX@operamail.com&gt;
# This script was written by tradetaxfree and is found at http://crunchbanglinux.org/forums/topic/15344/zram-a-good-idea/
# Copy this script (as root) from /usr/local/bin to /etc/init.d and then #update-rc.d zram defaults
# After booting verify the module is loaded with: lsmod | grep zram
### END INIT INFO

start() {
    # get the number of CPUs
    num_cpus=$(grep -c processor /proc/cpuinfo)
    # if something goes wrong, assume we have 1
    [ "$num_cpus" != 0 ] || num_cpus=1

    # set decremented number of CPUs
    last_cpu=$((num_cpus - 1))
    
    #default Factor % = 90 change this value here or create /etc/default/zram
    FACTOR=25
    #&amp; put the above single line in /etc/default/zram with the value you want
	[ -f /etc/default/zram ] &amp;&amp; source /etc/default/zram || true
	factor=$FACTOR # percentage

    # get the amount of memory in the machine
    memtotal=$(grep MemTotal /proc/meminfo | awk ' { print $2 } ')
    mem_by_cpu=$(($memtotal/$num_cpus*$factor/100*1024))

    # load dependency modules
    # attempt load using syntax for kernels 3.4 onwards falling back to syntax for kernels 3.1 - 3.3
    if ! modprobe zram num_devices=$num_cpus &amp;&amp; ! modprobe zram zram_num_devices=$num_cpus; then
      echo -e "Your Kernel needs to be compiled with ZRAM support:" \
      "\n\nDevice Drivers --&gt; Staging Drivers --&gt; Compressed RAM block device support (M)" \
      "\nDevice Drivers --&gt; Staging Drivers --&gt; Dynamic compression of swap pages and clean pagecache pages (*)" \
      "\n\nThe Liquorix Kernel (http://liquorix.net) has ZRAM support built in."
      exit 1
    fi
    echo "zram devices probed successfully"
    
    # initialize the devices
    for i in $(seq 0 $last_cpu); do
    echo $mem_by_cpu &gt; /sys/block/zram$i/disksize
    # Creating swap filesystems
    mkswap /dev/zram$i
    # Switch the swaps on
    swapon -p 100 /dev/zram$i
    done
}

stop() {
    # get the number of CPUs
    num_cpus=$(grep -c processor /proc/cpuinfo)

    # set decremented number of CPUs
    last_cpu=$((num_cpus - 1))

    # Switching off swap
    for i in $(seq 0 $last_cpu); do
    if [ "$(grep /dev/zram$i /proc/swaps)" != "" ]; then
    swapoff /dev/zram$i
    sleep 1
    fi
    done

    sleep 1
    rmmod zram
}

case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart)
        stop
        sleep 3
        start
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        RETVAL=1
esac
exit $RETVAL</pre>
<p>The original source of this script can be found here:<br />
<a title="zram init script" href="http://crunchbanglinux.org/forums/topic/15344/zram-a-good-idea/" target="_blank" rel="noopener">http://crunchbanglinux.org/forums/topic/15344/zram-a-good-idea/</a></p>
<p>The creator also notes that the latest version of the script can be found here: <a title="Latest Version of zram Script" href="http://dl.dropbox.com/u/96561917/zram.zip">http://dl.dropbox.com/u/96561917/zram.zip</a></p>
<p>We do make some slight changes to the script.</p>
<p>The if statement for the module loading has been corrected to not exit if it successfully loads using syntax for kernels 3.4 and onward.</p>
<p>Additionally take note of the change we make to FACTOR in the script from the default 90 to 25. We implement this change due to the following comment from one of ZRAM&#8217;s developers (back when it was known as Compcache): <a title="ZRAM (Compcache) Nitin Gupta Comment" href="https://code.google.com/p/compcache/wiki/CompilingAndUsingNew">https://code.google.com/p/compcache/wiki/CompilingAndUsingNew</a></p>
<blockquote><p><span class="author">Comment by project member <a class="userlink" href="https://code.google.com/u/nitingupta910@gmail.com/">nitingupta910@gmail.com</a>, </span> <span class="date" title="Fri May  7 01:35:52 2010">May 7, 2010</span></p>
<p>@Paczesiowa: ramzswap should not be given so much of memory as its just a (virtual) swap device &#8212; it can compress only anonymous (say, process stack, heap etc.) memory. There are also other kinds of caches in the system, say filesystem cache which also require lot of memory. So, to have a good balance among all the different caches, ramzswap should not be given nearly 100% of RAM.</p>
<p>Appropriate amount of ramzswap memory depends on kind of workload. For typical desktop workloads, I found 25% to work just fine (this is the default).</p></blockquote>
<h3>Enabling the Startup Script:</h3>
<p>Enable execute permissions on the startup script:<br />
<code>chmod +x /etc/init.d/zram</code></p>
<p>Add the startup script to the default run level:<br />
<code>update-rc.d zram defaults</code></p>
<h3>Verify:</h3>
<p>Now either run the script manually:<br />
<code>/etc/init.d/zram start</code><br />
or reboot (preferred since this will test if the script auto executes on boot).</p>
<p>Verify that the module is loaded:<br />
<code>lsmod | grep zram</code></p>
<p>If the result is a line starting with zram then it is loaded.</p>
<p>Verify that the compressed block devices are setup and running as available swap devices:<br />
<code>swapon -s</code></p>
<p>If you see devices listed such as /dev/zram0, /dev/zram1,&#8230; then the compressed block devices are enabled as swap devices and the setup of ZRAM is complete.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/increasing-linux-vps-ram-for-free-zram-rcscript/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Restore an Acer C720 Chromebook to stock after installing Linux on it</title>
		<link>http://www.codeapex.com/restore-an-acer-c720-chromebook-to-stock-after-installing-linux-on-it/</link>
					<comments>http://www.codeapex.com/restore-an-acer-c720-chromebook-to-stock-after-installing-linux-on-it/#comments</comments>
		
		<dc:creator><![CDATA[Code Apex]]></dc:creator>
		<pubDate>Fri, 25 Jul 2014 18:42:23 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<guid isPermaLink="false">https://www.codeapex.com/?p=4</guid>

					<description><![CDATA[Situation: Following a guide on the internet such as this one here for getting Linux installed on an Acer C720 Chromebook, summarized you: Switched the Chromebook to Developer Mode Enabled SeaBIOS Made SeaBIOS default on boot. Installed Linux Objective: Restore the Acer C720 Chromebook back to factory stock. Plan + Execution: First realize there are [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2>Situation:</h2>
<p>Following a guide on the internet such as this one <a title="Installing Bodhi Linux on an Acer C720 Chromebook with SeaBIOS as default." href="http://www.codeapex.com/installing-bodhi-linux-on-an-acer-c720-chromebook-with-seabios-as-default/" target="_blank">here</a> for getting Linux installed on an Acer C720 Chromebook, summarized you:</p>
<ol>
<li>Switched the Chromebook to Developer Mode</li>
<li>Enabled SeaBIOS</li>
<li>Made SeaBIOS default on boot.</li>
<li>Installed Linux</li>
</ol>
<h2>Objective:</h2>
<p>Restore the Acer C720 Chromebook back to factory stock.</p>
<h2>Plan + Execution:</h2>
<p><span id="more-4"></span></p>
<p>First realize there are essentially two things we want back at stock:</p>
<ol>
<li>A fresh Chrome OS installed.</li>
<li>The default BIOS and its stock settings.</li>
</ol>
<h3>Restoring Chrome OS</h3>
<ol>
<li>Find your version of your Chromebook by holding Ctrl+D on boot to get to the recovery screen. You will need it when creating the recovery USB flash drive by entering it when it asks for it in the creation script.</li>
<li>Create a recovery USB flash drive for Chrome OS, follow the directions in step 2 here for the OS you are creating the recovery USB flash drive in: <a title="Create a recovery USB flash drive" href="https://support.google.com/chromebook/answer/1080595?hl=en" target="_blank">https://support.google.com/chromebook/answer/1080595?hl=en</a> or see directions for Linux and Windows below:<br />
<span class="collapseomatic " id="id63629251ec070"  tabindex="0" title="Directions for creating the recovery USB flash drive in Linux"    >Directions for creating the recovery USB flash drive in Linux</span><div id="target-id63629251ec070" class="collapseomatic_content ">
<ol>
<li>
<blockquote><p>Click this link to download the Recovery Tool: <a href="https://dl.google.com/dl/edgedl/chromeos/recovery/linux_recovery.sh" target="_blank">https://dl.google.com/dl/edgedl/chromeos/recovery/linux_recovery.sh</a></p></blockquote>
</li>
<li>
<blockquote><p>Modify the script permissions to allow execution with the following command: <code>$ sudo chmod 755 linux_recovery.sh</code></p></blockquote>
</li>
<li>
<blockquote><p>Run the script with root privileges with the following command: <code>$ sudo bash linux_recovery.sh</code></p></blockquote>
</li>
<li>
<blockquote><p>Follow the prompts from the tool to complete building the operating system image.</p></blockquote>
</li>
</ol>
</div>
<br />
<span class="collapseomatic " id="id63629251ec095"  tabindex="0" title="Directions for creating the recovery USB flash drive in Windows"    >Directions for creating the recovery USB flash drive in Windows</span><div id="target-id63629251ec095" class="collapseomatic_content ">
<ol>
<li>
<blockquote><p>Click this link to download the Recovery Tool: <a href="https://dl.google.com/dl/chromeos/recovery/chromeosimagecreatorV2.exe" target="_blank">https://dl.google.com/dl/chromeos/recovery/chromeosimagecreatorV2.exe</a> If you&#8217;re a network administrator for your school, business, or organization, click this link to download the Recovery Tool: <a href="https://dl.google.com/dl/chromeos/recovery/chromeosimagecreator.exe" target="_blank">https://dl.google.com/dl/chromeos/recovery/chromeosimagecreator.exe</a></p></blockquote>
</li>
<li>
<blockquote><p>Run the tool and follow the instructions that appear on your screen.</p></blockquote>
</li>
<li>
<blockquote><p>After you recover your Chromebook, you <em><strong>must</strong></em> format your USB flash drive or SD card using the Recovery Tool. If you don&#8217;t format your USB flash drive or SD card, you won’t be able to use all the storage space on your external device. Additionally, your USB flash drive or SD card may not be recognizable by Windows. <a href="https://support.google.com/chromebook/answer/2554370">See instructions for reformatting your USB flash drive or SD card</a>.</p></blockquote>
</li>
</ol>
</div></li>
<li>Reinstall Chrome OS, step 3 here <a title="Create a recovery USB flash drive" href="https://support.google.com/chromebook/answer/1080595?hl=en" target="_blank">https://support.google.com/chromebook/answer/1080595?hl=en</a> or see directions below:<br />
<span class="collapseomatic " id="id63629251ec0ae"  tabindex="0" title="Reinstall Chrome OS, step 3"    >Reinstall Chrome OS, step 3</span><div id="target-id63629251ec0ae" class="collapseomatic_content ">
<ol>
<li>
<blockquote><p>Start your Chromebook.</p></blockquote>
</li>
<li>
<blockquote><p>When the &#8220;Chrome OS is missing or damaged&#8221; screen appears, insert the USB flash drive or SD card you created into the USB port or SD card slot on your Chrome device. Note if the Chromebook is not booting to Recovery mode by default, hold down the <span style="color: #990000;">ESC</span> and <span style="color: #990000;">Refresh</span> (F3) keys and press the <span style="color: #990000;">Power</span> button to get into Recovery mode.</p></blockquote>
</li>
<li>
<blockquote><p>Wait for the Chromebook to boot up from the flash drive.</p></blockquote>
</li>
<li>
<blockquote><p>Follow the instructions that appear on the screen.</p></blockquote>
</li>
<li>
<blockquote><p>On successful installation of the Chrome operating system, you will be prompted to remove the USB flash drive or SD card.</p></blockquote>
</li>
<li>
<blockquote><p>Remove the USB flash drive or SD card when prompted, and your Chromebook will automatically restart.</p></blockquote>
</li>
</ol>
</div></li>
</ol>
<h3>Restore the default BIOS with stock settings</h3>
<ol>
<li>Remove the write-protect screw inside the Chromebook. Recall from when you did this to set SeaBIOS as default originally, it is screw 7 here: <a href="http://www.chromium.org/_/rsrc/1381990807648/chromium-os/developer-information-for-chrome-os-devices/acer-c720-chromebook/c720-chromebook-annotated-innards.png">http://www.chromium.org/_/rsrc/1381990807648/chromium-os/developer-information-for-chrome-os-devices/acer-c720-chromebook/c720-chromebook-annotated-innards.png </a>Note: Putting the cover back on with just screw 6 in should be enough to boot and complete the rest of the needed steps before putting the write-protect screw back in.</li>
<li>Switch the Chromebook to Developer mode: First hold down the <span style="color: #990000;">ESC</span> and <span style="color: #990000;">Refresh</span> (F3) keys and press the <span style="color: #990000;">Power</span> button to power on the Chromebook. Then at the Recovery screen press <span style="color: #990000;">Ctrl-D</span>. It will ask you to confirm, then reboot into dev-mode.On boot you will see a warning screen and will need to press <span style="color: #990000;">Ctrl-D</span> or wait 30 seconds to continue booting.</li>
<li>Start a terminal session. There are two ways to start a terminal session in Chrome OS (in dev-mode): VT-2 or crosh. For our purposes here it does not matter which way is used.<br />
<span class="collapseomatic " id="id63629251ec0cb"  tabindex="0" title="Get the command prompt through VT-2"    >Get the command prompt through VT-2</span><div id="target-id63629251ec0cb" class="collapseomatic_content ">
<blockquote>
<h4>Get the command prompt through VT-2</h4>
<p>One way to get the login prompt is through something called VT-2, or &#8220;virtual terminal 2&#8221;. This is probably familiar to the Linux hackers out there. You can get to VT-2 by pressing:</p>
<div>[ Ctrl ] [ Alt ] [ =&gt; ]</div>
<p>&#8230;where the [ =&gt; ] key is the right-arrow key just above the number 3 on your keyboard.</p>
<p>Once you have the login prompt, you should see a set of instructions telling you about command-line access. <span style="color: #ff0000;">By default, you can login as the </span><code style="color: #38761d;">chronos</code><span style="color: #ff0000;"> user with no password. This includes the ability to do password-less sudo.</span> The instructions on the screen will tell you how you can set a password. They also tell you how to disable screen dimming.</p>
<div>The instructions do tell you how to get back to the browser, but because it&#8217;s so important, I&#8217;ll also put it here. Just press:</div>
<blockquote style="margin: 0px 0px 0px 40px; border-style: none; padding: 0px;">
<div>
<div>[ Ctrl ] [ Alt ] [ &lt;= ]</div>
</div>
</blockquote>
<div>&#8230;where the [ &lt;= ] key is the left-arrow key just above the number 1 on your keyboard.</div>
<p><b>SIDE NOTE</b>: For the technical-minded, you may realize that the top-rows of the keyboard on a Chrome OS device are actually treated by Linux as the keys F1 through F10. Thus, the [ =&gt; ] key is actually F2 and the [ &lt;= ] key is actually F1.</p>
<p><b>SIDE NOTE</b>: If you&#8217;re fooling around, you might also notice that kernel messages show up on VT-8.</p>
<hr />
</div>
<br />
<span class="collapseomatic " id="id63629251ec107"  tabindex="0" title="Getting the command prompt through crosh"    >Getting the command prompt through crosh</span><div id="target-id63629251ec107" class="collapseomatic_content ">
<h4>Getting the command prompt through crosh</h4>
<div>Because you booted into developer mode, you also have an alternate way to get a terminal prompt. I&#8217;ll mention this as well, since the alternate shell is a little nicer (in the very least, it keeps your screen from dimming on you), even if it is a little harder to get to. To use this alternate way:</div>
<div>
<ol style="list-style-type: decimal;">
<li>Go through the standard Chrome OS login screen (you&#8217;ll need to setup a network, etc) and get to the web browser. It&#8217;s OK if you login as guest.</li>
<li>Press [ Ctrl ] [ Alt ] [ T ] to get the crosh shell.</li>
<li>Use the <code style="color: #006000;">shell</code> command to get the shell prompt. NOTE: even if you set a password for the <code>chronos</code> user, you won&#8217;t need it here (though you still need it for <code>sudo</code> access)</li>
</ol>
</div>
<p>Note that entering the shell this way doesn&#8217;t give you all the instructions that VT-2 does (like how to set your password). You might want to follow the VT-2 steps once just to get the instructions.</p>
<p>If you want to get back to the browser without killing the shell, you can do it with [ Alt ] [ Tab ].</p>
<p><b>SIDE NOTE</b>: You can actually create as many shells as you want. Just hit [ Ctrl ] [ Alt ] [ T ] again and a second shell will be opened. You can [ Alt ] [ Tab ] between them.</p></blockquote>
</div></li>
<li>In the terminal open a bash shell with the <code>shell</code> command. Then become superuser with <code>sudo bash</code>.</li>
<li>Run these commands:
<ol>
<li><code>crossystem dev_boot_usb=1 dev_boot_legacy=1 disable_dev_request=1</code></li>
<li><code>flashrom --wp-disable</code></li>
<li><code>set_gbb_flags.sh 0×000<br />
</code>(note: if set_gbb_flags.sh is not found then try this full path to script: /usr/share/vboot/bin/set_gbb_flags.sh 0x000)</li>
<li><code>flashrom --wp-enable</code></li>
<li><code>chromeos-firmwareupdate --sb_extract /tmp</code></li>
<li><code>flashrom -w /tmp/bios.bin -i RW_LEGACY</code></li>
</ol>
</li>
<li>Shutdown the Chromebook and replace the write-protect screw. Put the backcover back on with all the screws.</li>
<li>The Chromebook should now be returned to stock.</li>
</ol>
]]></content:encoded>
					
					<wfw:commentRss>http://www.codeapex.com/restore-an-acer-c720-chromebook-to-stock-after-installing-linux-on-it/feed/</wfw:commentRss>
			<slash:comments>19</slash:comments>
		
		
			</item>
	</channel>
</rss>
